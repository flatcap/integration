From 14088ac734c0f6d3ef01fa7a8502370895f08e4f Mon Sep 17 00:00:00 2001
From: Richard Russon <rich@flatcap.org>
Date: Mon, 30 May 2016 03:46:36 +0100
Subject: [PATCH 09/13] change_folder_next

---
 PATCHES     | 1 +
 curs_main.c | 7 +++++++
 init.h      | 7 +++++++
 mutt.h      | 1 +
 4 files changed, 16 insertions(+)

diff --git a/PATCHES b/PATCHES
index e709cae..2d95814 100644
--- a/PATCHES
+++ b/PATCHES
@@ -1,3 +1,4 @@
+fg.change_folder_next
 vvv.quote
 patch-1.5.4.lpr.collapse_flagged Lukas P. Ruf <lukas.ruf@lpr.ch>
 patch-ifdef-neo-UNKNOWN
diff --git a/curs_main.c b/curs_main.c
index 6762af2..a63611f 100644
--- a/curs_main.c
+++ b/curs_main.c
@@ -1802,7 +1802,14 @@ int mutt_index_menu (void)
 	  }
 	  else
 #endif
+	{
+	  if (option (OPTCHANGEFOLDERNEXT) && Context && Context->path)
+	  {
+	    strfcpy (buf, Context->path, sizeof (buf));
+	    mutt_pretty_mailbox (buf, sizeof(buf));
+	  }
 	  mutt_buffy (buf, sizeof (buf));
+	}
 
 #ifdef USE_SIDEBAR
 	  if (op == OP_SIDEBAR_OPEN) {
diff --git a/init.h b/init.h
index b426fdf..8d7bf9b 100644
--- a/init.h
+++ b/init.h
@@ -394,6 +394,13 @@ struct option_t MuttVars[] = {
   ** mailbox by performing a fast mailbox scan when it is defined.
   ** Afterwards the new mail status is tracked by file size changes.
   */
+  { "change_folder_next", DT_BOOL, R_NONE, OPTCHANGEFOLDERNEXT, 0 },
+  /*
+  ** .pp
+  ** When this variable is set, the change-folder command will start at the
+  ** next folder after the current folder in your mailbox list instead of
+  ** starting at the first folder.
+  */
   { "check_new",	DT_BOOL, R_NONE, OPTCHECKNEW, 1 },
   /*
   ** .pp
diff --git a/mutt.h b/mutt.h
index db86be3..c4d851e 100644
--- a/mutt.h
+++ b/mutt.h
@@ -375,6 +375,7 @@ enum
   OPTBEEP,
   OPTBEEPNEW,
   OPTBOUNCEDELIVERED,
+  OPTCHANGEFOLDERNEXT,
   OPTBRAILLEFRIENDLY,
   OPTCHECKMBOXSIZE,
   OPTCHECKNEW,
-- 
2.8.2

