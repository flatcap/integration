From bfd4174b1c15b387c1fbbe0c107c528c240a8130 Mon Sep 17 00:00:00 2001
From: Richard Russon <rich@flatcap.org>
Date: Fri, 27 May 2016 03:10:07 +0100
Subject: [PATCH 12/12] bsc907453-CVE-2014-9116-jessie

---
 lib.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/lib.c b/lib.c
index 3c11499..aaaf721 100644
--- a/lib.c
+++ b/lib.c
@@ -828,6 +828,9 @@ char *mutt_substrdup (const char *begin, const char *end)
   size_t len;
   char *p;
 
+  if (end != NULL && end < begin)
+    return NULL;
+
   if (end)
     len = end - begin;
   else
-- 
2.7.4

