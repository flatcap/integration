From d6621b3284e8901810c92acf33f06d3b2b8885af Mon Sep 17 00:00:00 2001
From: Richard Russon <rich@flatcap.org>
Date: Fri, 27 May 2016 03:10:07 +0100
Subject: [PATCH 13/13] bsc907453-CVE-2014-9116-jessie

---
 lib.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/lib.c b/lib.c
index 784ff7c..e9c015d 100644
--- a/lib.c
+++ b/lib.c
@@ -824,6 +824,9 @@ char *mutt_substrdup (const char *begin, const char *end)
   size_t len;
   char *p;
 
+  if (end != NULL && end < begin)
+    return NULL;
+
   if (end)
     len = end - begin;
   else
-- 
2.8.2

