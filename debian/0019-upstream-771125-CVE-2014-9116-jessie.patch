From 90520dc571386ccbe0ba90ec3c0c07266efe7964 Mon Sep 17 00:00:00 2001
From: Richard Russon <rich@flatcap.org>
Date: Fri, 6 May 2016 00:24:03 +0100
Subject: [PATCH 19/19] upstream/771125-CVE-2014-9116-jessie

---
 lib.c | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/lib.c b/lib.c
index fa3067e..f46e975 100644
--- a/lib.c
+++ b/lib.c
@@ -819,6 +819,9 @@ char *mutt_substrdup (const char *begin, const char *end)
   size_t len;
   char *p;
 
+  if (end != NULL && end < begin)
+    return NULL;
+
   if (end)
     len = end - begin;
   else
-- 
2.7.4

