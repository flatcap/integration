From 8f15c3569e528d57350ae4854ae5d68cb9db9269 Mon Sep 17 00:00:00 2001
From: Richard Russon <rich@flatcap.org>
Date: Fri, 25 Mar 2016 18:30:01 +0000
Subject: [PATCH 10/10] neomutt customisations

---
 ChangeLog.neomutt | 73 ++++++++++++++++++++++++++++++++++++++++++++++++++
 Makefile.am       |  6 +++--
 README.neomutt    | 79 +++++++++++++++++++++++++++++++++++++++++++++++++++++++
 VERSION.neo       |  1 +
 doc/Makefile.am   |  3 ++-
 version.c         | 12 ++++++---
 version.sh        |  2 +-
 7 files changed, 168 insertions(+), 8 deletions(-)
 create mode 100644 ChangeLog.neomutt
 create mode 100644 README.neomutt
 create mode 100644 VERSION.neo
 mode change 100644 => 100755 version.sh

diff --git a/ChangeLog.neomutt b/ChangeLog.neomutt
new file mode 100644
index 0000000..1e96692
--- /dev/null
+++ b/ChangeLog.neomutt
@@ -0,0 +1,73 @@
+* Mon May 23 2016 Richard Russon <rich@flatcap.org> - NeoMutt-20160523
+- New Features:
+  - Keywords: Email Label/Keywords/Tagging
+  - Compress: Compressed mailboxes support
+  - NNTP: Talk to a usenet news server
+
+* Mon May 02 2016 Richard Russon <rich@flatcap.org> - NeoMutt-20160502
+- Update for Mutt-1.6.0
+- Bug Fixes:
+  - Build for Notmuch works if Sidebar is disabled
+  - Sidebar functions work even if the Sidebar is hidden
+  - sidebar-next-new, etc, only find *new* mail, as documented
+  - Notmuch supports *very* long queries
+
+* Sat Apr 16 2016 Richard Russon <rich@flatcap.org> - NeoMutt-20160416
+- Big Bugfix Release
+- Bug Fixes:
+  - Fix crash caused by sidebar_folder_indent
+  - Allow the user to change mailboxes again
+  - Correct sidebar's messages counts
+  - Only sort the sidebar if we're asked to
+  - Fix refresh of pager when toggling the sidebar
+  - Compose mode: make messages respect the TITLE_FMT
+  - Conditional include if sys/syscall.h
+  - Build fix for old compilers
+  - Try harder to keep track of the open mailbox
+- Changes to Features
+  - Allow sidebar_divider_char to be longer
+    (it was limited to one character)
+  - Ignore case when sorting the sidebar alphabetically
+- Other Changes
+  - Numerous small tweaks to the docs
+  - Lots of minor code tidy-ups
+  - Enabling NotMuch now forcibly enables Sidebar
+    (it is dependent on it, for now)
+  - A couple of bug fixes from mutt/stable
+
+* Mon Apr 04 2016 Richard Russon <rich@flatcap.org> - NeoMutt-20160404
+- Update for Mutt-1.6.0
+- No other changes in this release
+
+* Mon Mar 28 2016 Richard Russon <rich@flatcap.org> - NeoMutt-20160328
+- New Features
+  - skip-quoted          - skip quoted text
+  - limit-current-thread - limit index view to current thread
+- Sidebar Intro - A Gentle Introduction to the Sidebar (with pictures).
+
+* Sun Mar 20 2016 Richard Russon <rich@flatcap.org> - NeoMutt-20160320
+- Numerous small bugfixes
+- TravisCI integration
+
+* Thu Mar 17 2016 Richard Russon <rich@flatcap.org> - NeoMutt-20160317
+- New Features
+  - notmuch - email search support
+  - ifdef   - improvements
+
+* Mon Mar 07 2016 Richard Russon <rich@flatcap.org> - NeoMutt-20160307
+- First NeoMutt release
+- List of Features:
+  - bug-fixes    - various bug fixes
+  - cond-date    - use rules to choose date format
+  - fmemopen     - use memory buffers instead of files
+  - ifdef        - conditional config options
+  - index-color  - theme the email index
+  - initials     - expando for author's initials
+  - nested-if    - allow deeply nested conditions
+  - progress     - show a visual progress bar
+  - quasi-delete - mark emails to be hidden
+  - sidebar      - overview of mailboxes
+  - status-color - theming the status bar
+  - tls-sni      - negotiate for a certificate
+  - trash        - move 'deleted' emails to a trash bin
+
diff --git a/Makefile.am b/Makefile.am
index 4e9e239..c32440b 100644
--- a/Makefile.am
+++ b/Makefile.am
@@ -157,8 +157,10 @@ keymap_alldefs.h: $(srcdir)/OPS $(srcdir)/OPS.SIDEBAR $(srcdir)/OPS.NOTMUCH $(sr
 		$(srcdir)/OPS.SIDEBAR $(srcdir)/OPS.MIX $(srcdir)/OPS.CRYPT $(srcdir)/OPS.SMIME \
 			> keymap_alldefs.h
 
-reldate.h: $(srcdir)/ChangeLog
-	echo 'const char *ReleaseDate = "'`head -n 1 $(srcdir)/ChangeLog | LC_ALL=C cut -d ' ' -f 1`'";' > reldate.h.tmp; \
+reldate.h: ChangeLog.neomutt
+	date=`head -n 1 $(top_srcdir)/ChangeLog.neomutt | LC_ALL=C cut -d ' ' -f 3-5` && \
+	date=`date -d "$$date" "+%Y-%m-%d"` && \
+	echo 'const char *ReleaseDate = "'$$date'";' > reldate.h.tmp; \
 	cmp -s reldate.h.tmp reldate.h || cp reldate.h.tmp reldate.h; \
 	rm reldate.h.tmp
 
diff --git a/README.neomutt b/README.neomutt
new file mode 100644
index 0000000..eeae2cf
--- /dev/null
+++ b/README.neomutt
@@ -0,0 +1,79 @@
+# This is the NeoMutt Project
+
+## What is NeoMutt?
+
+* NeoMutt is a project of projects.
+* A place to gather all the patches against Mutt.
+* A place for all the developers to gather.
+
+Hopefully this will build the community and reduce duplicated effort.
+
+NeoMutt was created when Richard Russon (FlatCap) took all the old Mutt patches,
+sorted through them, fixed them up and documented them.
+
+## What Features does NeoMutt have?
+
+| Name                 | Description
+|----------------------|-------------------------------------------------------
+| Compressed Folders   | Read from/write to compressed mailboxes
+| Conditional Dates    | Conditional Date Formatting
+| Fmemopen             | Use fmemopen(3) for speedier temporary files
+| Ifdef                | Conditional config options
+| Index Color          | Theming of the Index List
+| Initials Expando     | Expando for Author's Initials
+| Keywords             | Labels/Tagging for emails
+| Limit-Current-Thread | Limit Index View to Current Thread
+| Nested If            | Allow deeply nested conditionals in format strings
+| NNTP                 | Talk to a Usenet news server
+| Notmuch              | Powerful email search engine
+| Progress Bar         | Colourful Progress Bar
+| Quasi-Delete         | Hide emails from view, but don't delete them
+| Sidebar              | Panel containing list of Mailboxes
+| Skip-Quoted          | Skip Quoted Text
+| Status Color         | Theming of the Status Bar
+| TLS-SNI              | Negotiate with a Server for a Certificate
+| Trash Folder         | Move 'deleted' emails to a trash folder
+
+## Where is NeoMutt?
+
+- Source Code:     https://github.com/neomutt/neomutt
+- Releases:        https://github.com/neomutt/neomutt/releases/latest
+- Questions/Bugs:  https://github.com/neomutt/neomutt/issues
+- Website:         http://www.neomutt.org/
+- Development:     http://www.neomutt.org/devel/
+
+## NeoMutt Developers
+
+Here's a list of everyone who's helped NeoMutt:
+
+Alex Pearce, Antonio Radici, Christoph Berg, Chris Salzberg, David Sterba,
+Evgeni Golov, Fabian Groffen, Fabio Alessandro Locati, Faidon Liambotis,
+Karel Zak, Kurt Jaeger, Matteo Vescovi, Richard Hartmann, Richard Russon,
+Udo Schweigert, Werner Fink.
+
+## Original Patch Authors
+
+Without the original patch authors, there would be nothing.
+So, a Big Thank You to:
+
+Aaron Schrab, Alain Penders, Benjamin Kuperman, Cedric Duval, Chris Mason,
+Christian Aichinger, Christoph Berg, Christoph Rissner, David Champion,
+David Riebenbauer, David Sterba, David Wilson, Don Zickus, Elimar Riesebieter,
+Eric Davis, Evgeni Golov, Fabian Groffen, Felix von Leitner, Jan Synacek,
+Jason DeTiberus, Jeremiah Foster, Jeremy Katz, Josh Poimboeuf, Julius Plenz,
+Justin Hibbits, Karel Zak, Kirill Shutemov, Luke Macken, Mantas Mikulenas,
+Matteo Vescovi, Patrick Brisbin, Paul Miller, Phil Pennock,
+Philippe Le Brouster, Richard Russon, Rocco Rutte, Roland Rosenfeld, Sami Farin,
+Stefan Assmann, Stefan Kuhn, Steve Kemp, Terry Chan, Thomas Glanzmann,
+Thomer Gil, Tim Stoakes, Tyler Earnest, Victor Manuel Jaquez Leal,
+Vincent Lefevre, Vladimir Marek, Vsevolod Volkov.
+
+## Original Mutt Authors
+
+And of course, we should thank the original Mutt authors, including the original
+author Michael Elkins and all the people that have contributed to Mutt during
+its long history, see the Acknowledgements section of the user manual for a
+detailed list.
+
+http://www.neomutt.org/manual/miscellany.html#acknowledgements
+
diff --git a/VERSION.neo b/VERSION.neo
new file mode 100644
index 0000000..9fcb455
--- /dev/null
+++ b/VERSION.neo
@@ -0,0 +1 @@
+-neo
diff --git a/doc/Makefile.am b/doc/Makefile.am
index 6021626..e502d47 100644
--- a/doc/Makefile.am
+++ b/doc/Makefile.am
@@ -191,7 +191,8 @@ smime_keys.1: $(srcdir)/smime_keys.man
 stamp-doc-xml: makedoc$(EXEEXT) $(top_srcdir)/init.h \
                manual.xml.head $(top_srcdir)/functions.h $(top_srcdir)/OPS* manual.xml.tail \
                $(srcdir)/gen-map-doc $(top_srcdir)/VERSION $(top_srcdir)/ChangeLog
-	( date=`head -n 1 $(top_srcdir)/ChangeLog | LC_ALL=C cut -d ' ' -f 1` && \
+	( date=`head -n 1 $(top_srcdir)/ChangeLog.neomutt | LC_ALL=C cut -d ' ' -f 3-5` && \
+	  date=`date -d "$$date" "+%Y-%m-%d"` && \
 	  sed -e "s/@VERSION\@/`cat $(top_srcdir)/VERSION` ($$date)/" $(srcdir)/manual.xml.head && \
 	  $(MAKEDOC_CPP) $(top_srcdir)/init.h | ./makedoc$(EXEEXT) -s && \
 	  $(MAKEDOC_CPP) $(top_srcdir)/functions.h | \
diff --git a/version.c b/version.c
index f67ae3c..ea5859f 100644
--- a/version.c
+++ b/version.c
@@ -84,8 +84,10 @@ static const char *Obtaining = N_(
 );
 
 static const char *ReachingUs = N_(
-	"To contact the developers, please mail to <mutt-dev@mutt.org>.\n"
-	"To report a bug, please visit http://bugs.mutt.org/.\n"
+	"To learn more about NeoMutt, visit: http://www.neomutt.org/\n"
+	"If you find a bug in NeoMutt, please raise an issue at:\n"
+	"    https://github.com/neomutt/neomutt/issues\n"
+	"or contact the lead developer: Richard Russon <rich@flatcap.org>\n"
 );
 
 static const char *Notice = N_(
@@ -457,9 +459,11 @@ print_version (void)
 	printf ("SYSCONFDIR=\"%s\"\n", SYSCONFDIR);
 	printf ("EXECSHELL=\"%s\"\n", EXECSHELL);
 
-	puts (_(ReachingUs));
-
+	puts ("");
 	mutt_print_patchlist();
+
+	puts ("");
+	puts (_(ReachingUs));
 }
 
 /**
diff --git a/version.sh b/version.sh
old mode 100644
new mode 100755
index d7988df..4f67822
--- a/version.sh
+++ b/version.sh
@@ -10,7 +10,7 @@ srcdir=`dirname "$0"` && cd "$srcdir" || exit 1
 # Ensure that we have a repo here and that mercurial is installed.  If
 # not, just cat the VERSION file; it contains the latest release number.
 { [ -d ".hg" ] && $HG >/dev/null 2>&1; } \
-|| exec cat VERSION
+|| { cat VERSION* | tr -d \\n; exit; }
 
 # This is a mercurial repo and we have the hg command.
 
-- 
2.8.2

